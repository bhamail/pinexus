<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 at 2019-02-28 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20190228" />
    <meta http-equiv="Content-Language" content="en" />
    <title>PiNexus &#x2013; Nexus Deamon Setup</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      </head>
    <body class="topBarDisabled">
      <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>PiNexus</h2>
</div>
</div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2019-02-28<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.0-SNAPSHOT</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
            <li class="nav-header">Overview</li>
    <li><a href="index.html" title="Introduction"><span class="icon-chevron-down"></span>Introduction</a>
      <ul class="nav nav-list">
    <li><a href="supplies.html" title="Supplies"><span class="none"></span>Supplies</a>  </li>
    <li><a href="setup.html" title="Setup"><span class="icon-chevron-down"></span>Setup</a>
      <ul class="nav nav-list">
    <li><a href="sdcardsetup.html" title="SD Card Setup"><span class="none"></span>SD Card Setup</a>  </li>
    <li><a href="ossetup.html" title="OS Setup"><span class="none"></span>OS Setup</a>  </li>
    <li><a href="nexussetup.html" title="Nexus Setup"><span class="none"></span>Nexus Setup</a>  </li>
    <li class="active"><a href="#"><span class="none"></span>Nexus Daemon</a>
  </li>
    <li><a href="repotest.html" title="Repo Test"><span class="none"></span>Repo Test</a>  </li>
      </ul>
  </li>
    <li><a href="docdocs.html" title="Doc docs"><span class="none"></span>Doc docs</a>  </li>
      </ul>
  </li>
          <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a>  </li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a>  </li>
  </ul>
          <hr />
          <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<h1>Nexus Deamon Setup</h1>
<p>Before attempting to configure the deamon settings below, be sure you stop any running instances of Nexus.</p>
<p>To enable Nexus to launch automatically at system boot time, make the following changes:</p>
<ol style="list-style-type: decimal">

<li>

<p>Create a new init.d script, named: <tt>nexusd</tt>, in order to install Nexus as a system service:</p>

<div>
<div>
<pre class="source">pi@raspberrypi:~ $ cd /etc/init.d/
pi@raspberrypi:/etc/init.d $ sudo vi nexusd
</pre></div></div>

<p>Paste the following content into this new file, and save the file:</p>

<div>
<div>
<pre class="source">#!/bin/sh
### BEGIN INIT INFO
# Provides:          nexusd
# Required-Start:    $remote_fs $syslog
# Required-Stop:     $remote_fs $syslog
# Default-Start:     2 3 4 5
# Default-Stop:      0 1 6
# Short-Description: Start nexus daemon at boot time
# Description:       Enable nexus as a system service provided by daemon.
### END INIT INFO

NEXUS_HOME=&quot;/home/pi/nexus/nexus-3.15.2-01&quot;
NEXUS_USER=&quot;pi&quot;

. /lib/lsb/init-functions
log_daemon_msg &quot;Nexus daemon called with: $@&quot; &quot;nexusd&quot;

exec sudo -u &quot;$NEXUS_USER&quot; -- &quot;$NEXUS_HOME/bin/nexus&quot; &quot;$@&quot;

log_end_msg $?       
</pre></div></div>

<p>Here&#x2019;s a file with the same content you could just copy into <tt>/etc/init.d/</tt>: <a href="scripts/nexusd">nexusd</a></p>
<p>Be sure to edit the path if your NEXUS_HOME is different (e. g. using a different version).</p>
</li>
<li>

<p>Add execute permission to the new init.d script:</p>

<div>
<div>
<pre class="source">pi@raspberrypi:/etc/init.d $ sudo chmod +x nexusd        
</pre></div></div>
</li>
<li>

<p>Setup init scripts using <tt>update-rc.d</tt>:</p>

<div>
<div>
<pre class="source">pi@raspberrypi:/etc/init.d $ sudo update-rc.d nexusd defaults
</pre></div></div>
</li>
<li>

<p>Test the function of the init scripts:</p>

<div>
<div>
<pre class="source">pi@raspberrypi:~ $ sudo service nexusd start
</pre></div></div>

<p>or, just reboot the Pi and see if nexus is running after reboot:</p>

<div>
<div>
<pre class="source">pi@raspberrypi:~ $ sudo service nexusd status
...
Running ...
</pre></div></div>

<p>You can &#x2018;tail&#x2019; the nexus log file to watch startup progress using a command like this:</p>

<div>
<div>
<pre class="source">pi@raspberrypi:~ $ tail -n 500 -f ~/nexus/sonatype-work/nexus3/log/nexus.log
</pre></div></div>

<p>If for any reason, you want to remove the deamon, run this command:</p>

<div>
<div>
<pre class="source">pi@raspberrypi:~ $ sudo update-rc.d nexusd remove -f
</pre></div></div>
</li>
</ol>
<p>Next step: <a href="repotest.html">Repository Test</a></p><hr />
<p>Old Steps for JSW - for NX2 (no longer required)</p><hr />
<ul>

<li>To compile ARM compatible JSW service binary for ARM:
<p>see: <a class="externalLink" href="https://honnix.github.io/technology/raspberry%20pi/java/2013/07/14/sonatype-nexus-on-raspberry-pi">https://honnix.github.io/technology/raspberry%20pi/java/2013/07/14/sonatype-nexus-on-raspberry-pi</a></p>
<p>and: <a class="externalLink" href="https://ti57.blogspot.se/2013/05/apache-archiva-on-raspberry-pi.html">https://ti57.blogspot.se/2013/05/apache-archiva-on-raspberry-pi.html</a></p>
<p>Build notes: Worked with wrapper_3.5.25_src.</p>
<ul>

<li>

<p>use jsw <tt>build32.sh</tt> script</p>
</li>
<li>

<p>Fix/avoid error: <tt>fatal error: jni.h: No such file or directory</tt> by setting java home:</p>
<p>$ export JAVA_HOME=/usr/lib/jvm/jdk-8-oracle-arm-vfp-hflt</p>
</li>
</ul>
</li>
</ul>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2015&#x2013;2019.
All rights reserved.</p>
        </div>
        </div>
    </footer>
    </body>
</html>