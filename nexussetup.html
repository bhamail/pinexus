<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 at 2020-02-03 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20200203" />
    <meta http-equiv="Content-Language" content="en" />
    <title>PiNexus &#x2013; Nexus Setup</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      </head>
    <body class="topBarDisabled">
      <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>PiNexus</h2>
</div>
</div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2020-02-03<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.0-SNAPSHOT</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
            <li class="nav-header">Overview</li>
    <li><a href="index.html" title="Introduction"><span class="icon-chevron-down"></span>Introduction</a>
      <ul class="nav nav-list">
    <li><a href="supplies.html" title="Supplies"><span class="none"></span>Supplies</a>  </li>
    <li><a href="setup.html" title="Setup"><span class="icon-chevron-down"></span>Setup</a>
      <ul class="nav nav-list">
    <li><a href="sdcardsetup.html" title="SD Card Setup"><span class="none"></span>SD Card Setup</a>  </li>
    <li><a href="ossetup.html" title="OS Setup"><span class="none"></span>OS Setup</a>  </li>
    <li class="active"><a href="#"><span class="none"></span>Nexus Setup</a>
  </li>
    <li><a href="repotest.html" title="Repo Test"><span class="none"></span>Repo Test</a>  </li>
      </ul>
  </li>
    <li><a href="docdocs.html" title="Doc docs"><span class="none"></span>Doc docs</a>  </li>
      </ul>
  </li>
          <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a>  </li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a>  </li>
  </ul>
          <hr />
          <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<h1>Nexus Setup</h1>
<p>Thanks to the <a class="externalLink" href="https://github.com/sonatype-nexus-community/nexus-repository-installer">nexus-repository-installer</a> project on the <a class="externalLink" href="https://github.com/sonatype-nexus-community">Sonatype Community</a>, the steps to install (and update) Nexus Repository Manager are now greatly simplified.</p>
<p>The old manual steps are archived here for reference: <a href="obsolete/nexussetup.html">Old Nexus Setup</a>, <a href="obsolete/nexusdaemonsetup.html">Old Nexus Daemon</a></p>
<ol style="list-style-type: decimal">

<li>

<p>Use the latest Java 8 release version of Java available from OpenJDK.</p>
<p>Java runtimes above Java 8 <a class="externalLink" href="https://help.sonatype.com/repomanager3/system-requirements#SystemRequirements-Java">have not been verified</a> - do not use them:</p>

<div>
<div>
<pre class="source">pi@raspberrypi:~ $ java -version
java version &quot;1.8.0&quot;
Java(TM) SE Runtime Environment (build 1.8.0-b132)
Java HotSpot(TM) Client VM (build 25.0-b70, mixed mode)
</pre></div></div>
</li>
<li>

<p>Follow these <a class="externalLink" href="https://github.com/sonatype-nexus-community/nexus-repository-installer#apt-setup">Apt Setup</a> steps to add the installer package repository. You can run the last step to install Nexus Repository Manager, but then you should immediately stop the Nexus daemon to allow you to customize the memory settings for the Pi. For example:</p>

<div>
<div>
<pre class="source">sudo apt-get install nexus-repository-manager
sudo service nexus3 stop
</pre></div></div>
</li>
<li>

<p>If you run Nexus with the default memory settings, you could run into problems.</p>
<p>A Pi currently only has 1GB to 4GB of RAM, so you need to configure Nexus to use less RAM than normal, and allocate less direct memory for use by the <a class="externalLink" href="https://support.sonatype.com/hc/en-us/articles/115007093447-Optimizing-OrientDB-Database-Memory-">database</a>. Edit the <tt>nexusvm.options</tt> file:</p>

<div>
<div>
<pre class="source">sudo vi /opt/sonatype/nexus3/bin/nexus.vmoptions
</pre></div></div>

<p>Change:</p>

<div>
<div>
<pre class="source">-Xms1200M
-Xmx1200M
-XX:MaxDirectMemorySize=2G
</pre></div></div>

<p>to:</p>

<div>
<div>
<pre class="source">-Xms350M
-Xmx350M
-XX:MaxDirectMemorySize=350M
</pre></div></div>

<p>Additional steps for Nexus versions 3.19 and newer:</p>
<p>Also change:</p>

<div>
<div>
<pre class="source"> -Djava.endorsed.dirs=lib/endorsed
</pre></div></div>

<p>to:</p>

<div>
<div>
<pre class="source"> -Djava.endorsed.dirs=lib/endorsed:/opt/sonatype/jna
</pre></div></div>

<p><i>NOTE</i>: Newer versions of Nexus (3.19+) ship with a version of OrientDB which includes a version of <a class="externalLink" href="https://github.com/java-native-access/jna">jna</a> that accidentally omitted the ARM versions of some native libs.</p>
<p>The solution is to manually download a newer version of jna, via:</p>

<div>
<div>
<pre class="source"> sudo wget https://repo1.maven.org/maven2/net/java/dev/jna/jna/5.5.0/jna-5.5.0.jar
 sudo wget https://repo1.maven.org/maven2/net/java/dev/jna/jna-platform/5.5.0/jna-platform-5.5.0.jar
</pre></div></div>

<p>And move these two jars into a new directory:</p>

<div>
<div>
<pre class="source"> /opt/sonatype/jna
</pre></div></div>

<p>Just in case, chmod +x the .jars:</p>

<div>
<div>
<pre class="source"> sudo chmod +x /opt/sonatype/jna/*
</pre></div></div>
</li>
<li>

<p>Launch nexus.</p>
<p>To see the log output on the console, use this command:</p>

<div>
<div>
<pre class="source">sudo service nexus3 start
</pre></div></div>

<p>You can &#x2018;tail&#x2019; the nexus log file to watch startup progress using a command like this:</p>

<div>
<div>
<pre class="source">tail -n 500  -f /opt/sonatype/sonatype-work/nexus3/log/nexus.log
</pre></div></div>

<p>Watch for a message like:</p>

<div>
<div>
<pre class="source">-------------------------------------------------

Started Sonatype Nexus OSS 3.15.2-01

-------------------------------------------------
</pre></div></div>

<p>While Nexus is starting, you can monitor the system work load using <tt>top</tt>. Wait for the <tt>java</tt> process to ease up on the cpu (well below 100% CPU in <tt>top</tt>).  Then from your PC, open the link below to Nexus running on the Pi:</p>

<div>
<div>
<pre class="source">http://the-Pi-IP-address:8081
</pre></div></div>

<p>The default Nexus administrator credentials are user: <tt>admin</tt>, password: <tt>admin123</tt>.</p>
<p>Huzzah! Nexus is running on your Pi.</p>
</li>
</ol>
<p>Next step: <a href="repotest.html">Repository Test</a></p>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2015&#x2013;2020.
All rights reserved.</p>
        </div>
        </div>
    </footer>
    </body>
</html>